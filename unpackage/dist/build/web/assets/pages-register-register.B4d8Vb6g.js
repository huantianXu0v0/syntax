import{t as e,r as a,x as s,y as l,b as t,w as n,i as o,a as r,f as c,h as u,u as i,B as d,l as p,z as m,A as f,s as _,C as h,$ as k,p as g,I as b,D as w,q as y}from"./index-DwZjcXUC.js";import{_ as v}from"./uni-captcha.BU3uENCS.js";import{r as C}from"./uni-app.es.CIFaVD21.js";import"./store.DEtVyp6z.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-icons.DFbhKlHF.js";const V=x({__name:"register",setup(x){const V=e.importObject("uni-id-co"),U=a(!1),j=a(!1),I=a(null),P=s({username:"",nickname:"",password:"",passwordConfirm:"",captcha:""}),T=()=>{j.value=!j.value},N=()=>m({url:"/pages/index/index"}),R=()=>f({url:"/pages/login/login"}),q=()=>{I.value&&I.value.getImageCaptcha()},A=async()=>{if(!j.value)return _({title:"Please agree to terms",icon:"none"});if(!/^1\d{10}$/.test(P.username))return _({title:"Invalid mobile number",icon:"none"});if(!P.nickname)return _({title:"Nickname required",icon:"none"});if(P.password.length<6)return _({title:"Password too short (min 6)",icon:"none"});if(P.password!==P.passwordConfirm)return _({title:"Passwords do not match",icon:"none"});if(4!==P.captcha.length)return _({title:"Enter 4-digit captcha",icon:"none"});U.value=!0;try{const e=await V.registerUser({mobile:P.username,username:"u"+P.username,password:P.password,nickname:P.nickname,captcha:P.captcha});if(_({title:"Register Success!",icon:"success"}),0===e.errCode&&e.newToken){h("uni_id_token",e.newToken.token),h("uni_id_token_expired",e.newToken.tokenExpired),h("uni_id_uid",e.uid);const a={_id:e.uid,username:P.username,nickname:P.nickname,avatar:""};h("uni_id_userInfo",a),k("login-success",a),setTimeout((()=>{m({url:"/pages/index/index"})}),1500)}else setTimeout(R,1500)}catch(e){console.error(e),_({title:e.errMsg||"Register failed",icon:"none"}),q(),P.captcha=""}finally{U.value=!1}};return(e,a)=>{const s=g,m=o,f=b,_=C(l("uni-captcha"),v),h=w,k=y;return r(),t(m,{class:"auth-page"},{default:n((()=>[c(m,{class:"brand-side"},{default:n((()=>[c(m,{class:"brand-text"},{default:n((()=>[c(s,{class:"brand-logo"},{default:n((()=>[u("UNI-CLOUD")])),_:1}),c(s,{class:"brand-slogan"},{default:n((()=>[u("Join the"),i("br"),u("revolution.")])),_:1}),c(s,{class:"brand-desc"},{default:n((()=>[u("Join 10,000+ developers building the future of web applications with our platform.")])),_:1})])),_:1}),c(m,{class:"glass-decoration blue-theme"})])),_:1}),c(m,{class:"form-side"},{default:n((()=>[c(m,{class:"form-container"},{default:n((()=>[c(m,{class:"back-home",onClick:N},{default:n((()=>[u("â† Back to Home")])),_:1}),c(s,{class:"form-title"},{default:n((()=>[u("Create an account")])),_:1}),c(s,{class:"form-sub"},{default:n((()=>[u("Start your 30-day free trial. No credit card required.")])),_:1}),c(m,{class:"input-group"},{default:n((()=>[c(s,{class:"label"},{default:n((()=>[u("Mobile Number")])),_:1}),c(f,{class:"input",type:"number",maxlength:"11",modelValue:P.username,"onUpdate:modelValue":a[0]||(a[0]=e=>P.username=e),placeholder:"13800138000","placeholder-class":"ph-style"},null,8,["modelValue"])])),_:1}),c(m,{class:"input-group"},{default:n((()=>[c(s,{class:"label"},{default:n((()=>[u("Nickname")])),_:1}),c(f,{class:"input",type:"text",modelValue:P.nickname,"onUpdate:modelValue":a[1]||(a[1]=e=>P.nickname=e),placeholder:"Your display name","placeholder-class":"ph-style"},null,8,["modelValue"])])),_:1}),c(m,{class:"input-group"},{default:n((()=>[c(s,{class:"label"},{default:n((()=>[u("Password")])),_:1}),c(f,{class:"input",type:"password",modelValue:P.password,"onUpdate:modelValue":a[2]||(a[2]=e=>P.password=e),placeholder:"Min. 6 characters","placeholder-class":"ph-style"},null,8,["modelValue"])])),_:1}),c(m,{class:"input-group"},{default:n((()=>[c(s,{class:"label"},{default:n((()=>[u("Confirm Password")])),_:1}),c(f,{class:"input",type:"password",modelValue:P.passwordConfirm,"onUpdate:modelValue":a[3]||(a[3]=e=>P.passwordConfirm=e),placeholder:"Re-enter your password","placeholder-class":"ph-style"},null,8,["modelValue"])])),_:1}),c(m,{class:"input-group"},{default:n((()=>[c(s,{class:"label"},{default:n((()=>[u("Captcha")])),_:1}),c(m,{class:"captcha-box"},{default:n((()=>[c(m,{class:"captcha-img-wrapper",onClick:q},{default:n((()=>[c(_,{ref_key:"captchaRef",ref:I,scene:"register",modelValue:P.captcha,"onUpdate:modelValue":a[4]||(a[4]=e=>P.captcha=e),focus:!1},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(m,{class:"terms-check"},{default:n((()=>[c(m,{class:"checkbox-label",onClick:T},{default:n((()=>[c(h,{checked:j.value,style:{transform:"scale(0.7)","pointer-events":"none"},color:"#000"},null,8,["checked"]),c(s,{class:"terms-text"},{default:n((()=>[u("I agree to the "),c(s,{class:"link",onClick:a[5]||(a[5]=d((()=>{}),["stop"]))},{default:n((()=>[u("Terms")])),_:1}),u(" and "),c(s,{class:"link",onClick:a[6]||(a[6]=d((()=>{}),["stop"]))},{default:n((()=>[u("Privacy Policy")])),_:1}),u(".")])),_:1})])),_:1})])),_:1}),c(k,{class:"btn-submit",disabled:U.value,onClick:A},{default:n((()=>[u(p(U.value?"Creating...":"Get Started"),1)])),_:1},8,["disabled"]),c(m,{class:"footer-link"},{default:n((()=>[c(s,null,{default:n((()=>[u("Already have an account? ")])),_:1}),c(s,{class:"link-bold",onClick:R},{default:n((()=>[u("Log in")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-1c73903e"]]);export{V as default};
